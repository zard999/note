<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="public/css/register.css" />
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <div class="outer">
      <div class="con">
        <img src="public/img/logo.png" alt="" />
        <h2>尚硅谷学生管理系统注册账号</h2>
        <form class="ipts">
          <input type="text" id="user" placeholder="用户名" />
          <input type="oassword" id="pass" placeholder="密码" />
          <input type="password" id="passAgain" placeholder="再次输入密码" />
          <button id="btn">注册</button>
        </form>
      </div>
    </div>
    <script>
      const oUser = document.getElementById("user");
      const oPass = document.getElementById("pass");
      const oPassAgain = document.getElementById("passAgain");
      const oBtn = document.getElementById("btn");

      axios.interceptors.response.use(
        (response) => {
          // Do something before response is sent
          if (response.data.code == "100000") {
            return response.data.msg;
          } else {
            return Promise.reject(response.data.msg);
          }
        },
        (error) => {
          // Do something with response error
          return Promise.reject(error);
        }
      );

      oBtn.onclick = function () {
        const user = oUser.value;
        const pass = oPass.value;
        const passAgain = oPassAgain.value;
        if (user === "" || pass === "" || passAgain === "") {
          alert("不能为空");
          return false;
        }

        if (pass !== passAgain) {
          alert("第二次密码不一样");
          return false;
        }

        axios
          .post("/register", {
            user,
            pass,
          })
          .then((res) => {
            alert(res);
            location.href = "./login.html";
          })
          .catch((err) => {
            alert(err);
          });

        return false;
      };
    </script>
  </body>
</html>
